import{m as Q,n as J,l as f,y as W,p as X,v as p,s as v,Q as L,R as M,q as Z,S as T,u as le,o as ae,r as oe,E as te,G as ne,K as ue,d as V,L as re,g as se}from"./@ionic-BYXd9M1L.js";import{a as de,j as I,k as ie}from"./ionicons-vuVtR0Xh.js";import{u as q}from"./index-m1nEGGOe.js";import{u as ce,g as me,a as pe}from"./user-DSozrzyY.js";import{h as G}from"./https-D-b4uF_s.js";import{d as ee,r as m,aG as fe,aM as c,a1 as E,aa as l,by as a,be as e,a9 as d,a2 as w,H as $,aU as R,$ as b,b7 as Y,c as ve,b as ye,a0 as F,aP as _e,aN as be}from"./@vue-yfti66JX.js";import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./@stencil-CHpqkKxm.js";import"./vue-router-C1vmwl4t.js";import"./pinia-FlwmMssk.js";import"./register-service-worker-TYP_X6yW.js";/* empty css                  */import"./axios-CwoVb0Lo.js";import"./vue-toast-notification-BuDNWbXa.js";import"./vue-0gI2gMPI.js";const ge=()=>G.get("/api/countries"),Ve=y=>G.get("/api/countries/".concat(y,"/states")),Ce=y=>G.get("/api/states/".concat(y,"/cities")),Ie=ee({__name:"ModalProfile",props:{userId:Object,avatar:File},setup(y){var i,t;const r=m({id:0,email:"",name:"",first_name:"",second_name:"",password:"",role_id:0,city_id:0,deleted_at:null}),S=y,O=()=>T.dismiss(null,"cancel");q();const k=m(),U=m(),A=m(),C=m([]),g=m(),s=m([]);r.value=S.userId,k.value=(i=r.value.city)==null?void 0:i.state.country_id,U.value=(t=r.value.city)==null?void 0:t.state_id,g.value=r.value.city_id;const _=async()=>{try{A.value=(await ge()).data}catch(o){console.error("Hubo un error al traer las ciudades")}},h=async o=>{try{C.value=(await Ve(o)).data}catch(u){console.error("Hubo un error al traer los estados")}},x=async o=>{try{s.value=(await Ce(o)).data}catch(u){console.error("Hubo un error en al traer las ciudades",u)}},N=o=>{h(o.detail.value)},j=o=>{x(o.detail.value)},B=o=>{r.value.city_id=o.detail.value},D=async()=>{var n,K;const o={email:r.value.email,name:r.value.name,first_name:r.value.first_name,second_name:r.value.second_name,phone:r.value.phone,city_id:r.value.city_id,image:S.avatar},u=new FormData;for(const H in o)if(Object.prototype.hasOwnProperty.call(o,H)){const z=H,P=o[z];P instanceof File?u.append(z,P):u.append(z,(n=P==null?void 0:P.toString())!=null?n:"")}try{const H=(await ce((K=S.userId)==null?void 0:K.id,u)).data;T.dismiss("confirm")}catch(H){console.error("Algo salio mal al actualizar.")}};return fe(()=>{var o,u;_(),h((o=r.value.city)==null?void 0:o.state.country_id),x((u=r.value.city)==null?void 0:u.state_id)}),(o,u)=>(c(),E($,null,[l(e(X),null,{default:a(()=>[l(e(Q),null,{default:a(()=>[l(e(J),{slot:"start"},{default:a(()=>[l(e(f),{color:"medium",onClick:O},{default:a(()=>[d("Cancel")]),_:1})]),_:1}),l(e(W),null,{default:a(()=>[d("Actualiza tú información")]),_:1}),l(e(J),{slot:"end"},{default:a(()=>[l(e(f),{onClick:D,strong:!0},{default:a(()=>[d("Confirm")]),_:1})]),_:1})]),_:1})]),_:1}),l(e(Z),{class:"ion-padding"},{default:a(()=>[w("form",{onSubmit:D},[l(e(p),null,{default:a(()=>[l(e(v),{"label-placement":"stacked",label:"Cambia tu nombre(s)",modelValue:r.value.name,"onUpdate:modelValue":u[0]||(u[0]=n=>r.value.name=n),placeholder:"Your name"},null,8,["modelValue"])]),_:1}),l(e(p),null,{default:a(()=>[l(e(v),{"label-placement":"stacked",label:"Cambia tu primer apellido",modelValue:r.value.first_name,"onUpdate:modelValue":u[1]||(u[1]=n=>r.value.first_name=n),placeholder:"Your second name"},null,8,["modelValue"])]),_:1}),l(e(p),null,{default:a(()=>[l(e(v),{"label-placement":"stacked",label:"Cambia tu segundo apellido",modelValue:r.value.second_name,"onUpdate:modelValue":u[2]||(u[2]=n=>r.value.second_name=n),placeholder:"Your last name"},null,8,["modelValue"])]),_:1}),l(e(p),null,{default:a(()=>[l(e(v),{"label-placement":"stacked",label:"Cambia tu cuenta de email",modelValue:r.value.email,"onUpdate:modelValue":u[3]||(u[3]=n=>r.value.email=n),placeholder:"Your email"},null,8,["modelValue"])]),_:1}),l(e(p),null,{default:a(()=>[l(e(v),{"label-placement":"stacked",label:"Cambia tu telefono",modelValue:r.value.phone,"onUpdate:modelValue":u[4]||(u[4]=n=>r.value.phone=n),placeholder:"(+52) 888-88-88"},null,8,["modelValue"])]),_:1}),l(e(p),{lines:"none"},{default:a(()=>[l(e(L),{modelValue:k.value,"onUpdate:modelValue":u[5]||(u[5]=n=>k.value=n),onIonChange:N,class:"mt-3 mr-2",label:"País","label-placement":"floating",fill:"outline"},{default:a(()=>[(c(!0),E($,null,R(A.value,n=>(c(),b(e(M),{value:n.id},{default:a(()=>[d(Y(n.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"]),l(e(L),{modelValue:U.value,"onUpdate:modelValue":u[6]||(u[6]=n=>U.value=n),onIonChange:j,class:"mt-3 mr-2",label:"Estado","label-placement":"floating",fill:"outline"},{default:a(()=>[(c(!0),E($,null,R(C.value,n=>(c(),b(e(M),{value:n.id},{default:a(()=>[d(Y(n.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"]),l(e(L),{modelValue:g.value,"onUpdate:modelValue":u[7]||(u[7]=n=>g.value=n),onIonChange:B,class:"mt-3",label:"Ciudad","label-placement":"floating",fill:"outline"},{default:a(()=>[(c(!0),E($,null,R(s.value,n=>(c(),b(e(M),{value:n.id},{default:a(()=>[d(Y(n.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),_:1})],32)]),_:1})],64))}}),we=y=>(_e("data-v-5454cdbc"),y=y(),be(),y),Se={class:"h-full flex flex-column justify-content-center align-items-center"},Ue=["src"],he=we(()=>w("img",{class:"border-circle",alt:"Silhouette of a person's head",src:"https://ionicframework.com/docs/img/demos/avatar.svg"},null,-1)),xe=ee({__name:"ProfileInfo",setup(y){const r=q(),S=ve(()=>r.userInfo),O=JSON.parse(S.value),k=m(!1),U=q(),A=le(),C=m(!1),g=m(),s=m({deleted_at:null}),_=async()=>{const i=await T.create({component:Ie,componentProps:{userId:s.value,avatar:x.value}});i.present();const{data:t,role:o}=await i.onWillDismiss();t==="confirm"&&await B()},h=()=>{document.getElementById("file-upload").click()},x=m(),N=i=>{const t=i.target.files[0];x.value=t,D(t)},j=()=>{U.logout(),C.value=!0,A.replace("/")},B=async()=>{var i;try{s.value=(await me(O.id)).data,console.log("NAME",s.value),g.value=(i=s.value.city)==null?void 0:i.state.country.name}catch(t){console.error("Hubo un errror al traer la información del usuario.")}},D=async i=>{const t=new FormData;t.append("image",i);try{const o=await pe(s.value.id,t);await B()}catch(o){console.error("Algo salio mal al actualizar.")}};return ye(()=>{B()}),(i,t)=>(c(),E($,null,[l(e(X),null,{default:a(()=>[l(e(Q),null,{default:a(()=>[l(e(J),{slot:"start"},{default:a(()=>[l(e(ae),{defaultHref:"/departments",icon:e(de)},null,8,["icon"])]),_:1}),l(e(W),null,{default:a(()=>[d("Perfil personal")]),_:1})]),_:1})]),_:1}),l(e(se),null,{default:a(()=>[l(e(Z),null,{default:a(()=>[w("div",Se,[l(e(oe),{class:"mb-6 w-full md:w-30rem"},{default:a(()=>[l(e(te),{class:"flex justify-content-center mt-5"},{default:a(()=>[s.value.avatar?(c(),b(e(ne),{key:0,onClick:h,class:"avatar_btn",as:"ion-button"},{default:a(()=>[w("img",{alt:"Silhouette of a person's head",src:s.value.avatar},null,8,Ue),w("input",{type:"file",id:"file-upload",style:{display:"none"},onChange:N},null,32)]),_:1})):s.value.avatar?F("",!0):(c(),b(e(f),{key:1,class:"w-2 h-2",onClick:h,size:"large",fill:"outline",color:"dark"},{default:a(()=>[w("input",{type:"file",id:"file-upload",style:{display:"none"},onChange:N},null,32),he]),_:1}))]),_:1}),l(e(ue),{class:"mt-5"},{default:a(()=>[l(e(p),null,{default:a(()=>[l(e(v),{label:"Nombre(s):",placeholder:"Jonh",modelValue:s.value.name,"onUpdate:modelValue":t[0]||(t[0]=o=>s.value.name=o),"label-placement":"stacked",readonly:""},null,8,["modelValue"]),l(e(f),{fill:"outline",color:"dark",onClick:t[1]||(t[1]=o=>_())},{default:a(()=>[d(" Edit "),l(e(V),{slot:"end",icon:e(I),color:"dark"},null,8,["icon"])]),_:1})]),_:1}),l(e(p),null,{default:a(()=>[l(e(v),{label:"Primer apellido:",placeholder:"Cena",modelValue:s.value.first_name,"onUpdate:modelValue":t[2]||(t[2]=o=>s.value.first_name=o),"label-placement":"stacked",readonly:""},null,8,["modelValue"]),l(e(f),{fill:"outline",color:"dark",onClick:t[3]||(t[3]=o=>_())},{default:a(()=>[d(" Edit "),l(e(V),{slot:"end",icon:e(I),color:"dark"},null,8,["icon"])]),_:1})]),_:1}),l(e(p),null,{default:a(()=>[l(e(v),{label:"Segundo apellido:",placeholder:"Rodríguez",modelValue:s.value.second_name,"onUpdate:modelValue":t[4]||(t[4]=o=>s.value.second_name=o),"label-placement":"stacked",readonly:""},null,8,["modelValue"]),l(e(f),{fill:"outline",color:"dark",onClick:t[5]||(t[5]=o=>_())},{default:a(()=>[d(" Edit "),l(e(V),{slot:"end",icon:e(I),color:"dark"},null,8,["icon"])]),_:1})]),_:1}),l(e(p),null,{default:a(()=>[l(e(v),{label:"email",placeholder:"email@email.com",modelValue:s.value.email,"onUpdate:modelValue":t[6]||(t[6]=o=>s.value.email=o),"label-placement":"stacked",readonly:!k.value},null,8,["modelValue","readonly"]),k.value?F("",!0):(c(),b(e(f),{key:0,fill:"outline",color:"dark",onClick:t[7]||(t[7]=o=>_())},{default:a(()=>[d(" Edit "),l(e(V),{slot:"end",icon:e(I),color:"dark"},null,8,["icon"])]),_:1})),k.value?(c(),b(e(f),{key:1,fill:"outline",color:"dark"},{default:a(()=>[d(" Save "),l(e(V),{slot:"end",icon:e(ie),color:"dark"},null,8,["icon"])]),_:1})):F("",!0)]),_:1}),l(e(p),null,{default:a(()=>[l(e(v),{label:"Phone",placeholder:"(+52) 888-888-88-88",modelValue:s.value.phone,"onUpdate:modelValue":t[8]||(t[8]=o=>s.value.phone=o),"label-placement":"stacked",readonly:""},null,8,["modelValue"]),l(e(f),{fill:"outline",color:"dark",onClick:t[9]||(t[9]=o=>_())},{default:a(()=>[d(" Edit "),l(e(V),{slot:"end",icon:e(I),color:"dark"},null,8,["icon"])]),_:1})]),_:1}),l(e(p),null,{default:a(()=>[l(e(v),{label:"País",placeholder:"your country",modelValue:g.value,"onUpdate:modelValue":t[10]||(t[10]=o=>g.value=o),"label-placement":"stacked",readonly:""},null,8,["modelValue"]),l(e(f),{fill:"outline",color:"dark",onClick:t[11]||(t[11]=o=>_())},{default:a(()=>[d(" Edit "),l(e(V),{slot:"end",icon:e(I),color:"dark"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),l(e(f),{onClick:j,class:"px-1 w-full md:w-30rem",expand:"block",fill:"outline",color:"dark"},{default:a(()=>[d("Cerrar Sesión")]),_:1}),C.value?(c(),b(e(re),{key:0,"is-open":C.value,message:"Cerrando sessión...",spinner:"circles",duration:2e3},null,8,["is-open"])):F("",!0)])]),_:1})]),_:1})],64))}}),Ye=ke(xe,[["__scopeId","data-v-5454cdbc"]]);export{Ye as default};
