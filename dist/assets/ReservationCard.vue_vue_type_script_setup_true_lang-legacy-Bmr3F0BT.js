System.register(["./axios-legacy-CUPSUh8R.js","./index-legacy-CW1NlSFU.js"],(function(e,a){"use strict";var t,l,n,u,o,i,d,s,r,v,c,_,p,f,m,g,h,y,k,w,x,D,I,b,C,$,O,T,M,N,S,X,j,q,A,z;return{setters:[e=>{t=e.a},e=>{l=e.d,n=e.O,u=e.f,o=e.r,i=e.a,d=e.u,s=e.N,r=e.o,v=e.c,c=e.g,_=e.w,p=e.e,f=e.E,m=e.D,g=e.t,h=e.C,y=e.B,k=e.W,w=e.V,x=e.ac,D=e.ag,I=e.ah,b=e.ae,C=e.b,$=e.s,O=e.X,T=e.ab,M=e.J,N=e.m,S=e.L,X=e.R,j=e.ai,q=e.n,A=e.af,z=e.K}],execute:function(){const a=N("h2",null,"Detalle de precio",-1),P=N("u",null,"Tarifia de servicio",-1),R=N("b",null,"Total(MXN)",-1);e("_",l({__name:"ReservationCard",setup(e){const l=n(),B=u(),E=o(0),F=o(),K=o(!0),V=o(!1),H=i((()=>Q.departmentInfo)),L=i((()=>Q.reservation)),U=o({date:{weekday:"short",month:"long",day:"2-digit"}}),Y=o({date_in:(new Date).toISOString().split("T")[0],date_out:new Date((new Date).setDate((new Date).getDate()+1)).toISOString().split("T")[0]}),G=o(""),J=o(),W=o(),Q=d(),Z=i((()=>Q.isLogged)),ee=(i((()=>Q.reservation)),e=>{var a;Y.value.date_out=null!==(a=e.detail.value)&&void 0!==a?a:"",console.log(e.detail.value)}),ae=e=>{var a;Y.value.date_in=null!==(a=e.detail.value)&&void 0!==a?a:""},te=(e,a)=>{const t=new Date(e),l=new Date(a),n=Math.abs(l.getTime()-t.getTime());if(!(l>t))return Math.ceil(n/864e5);K.value=!0,V.value=!1},le=async e=>{try{var a;const n=await t.post("https://api.stripe.com/v1/checkout/sessions",{success_url:`http://localhost:5173/departments/${l.params.id}/succes-payment?department=${null===(a=W.value)||void 0===a?void 0:a.name}&date_in=${Y.value.date_in}&date_out=${Y.value.date_out}&total=${J.value}`,cancel_url:`http://localhost:5173/departments/${l.params.id}`,line_items:[{price:e,quantity:F.value}],mode:"payment",payment_method_types:["card"]},{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer sk_test_IKYCHOAmUhC7IPTdaoVtO58D"}});console.log("url_check",n.data.url),Q.setCheckOutId(n.data.id),n.data.url&&(window.location.href=n.data.url)}catch(n){console.error("Error en el checkout",n)}},ne=async e=>{try{const a=await t.post("https://api.stripe.com/v1/prices",{currency:"mxn",unit_amount:100*e,"product_data[name]":"Gold Plan"},{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer sk_test_IKYCHOAmUhC7IPTdaoVtO58D"}});G.value=a.data.id}catch(a){console.error("No pudimos agregar el precio",a)}},ue=()=>{if(Y.value=L.value,W.value=H.value,E.value=W.value.price,F.value=te(Y.value.date_out,Y.value.date_in),F.value){J.value=E.value*F.value*1.1;const e=1.1*E.value;ne(parseInt(e.toFixed(2)))}};return Z.value,l.fullPath.includes("reservation")&&l.query.department&&ue(),s((()=>[L.value,Y.value.date_in,Y.value.date_out]),(e=>{(async()=>{if(W.value=H.value,E.value=W.value.price,F.value=te(Y.value.date_out,Y.value.date_in),F.value){J.value=E.value*F.value*1.1;const e=1.1*E.value;ne(parseInt(e.toFixed(2)))}})(),ue(),console.log("El valor de date_out ha cambiado a:",e)})),(e,t)=>(r(),v(z,null,[c(p(q),{class:"ion-padding-vertical w-9"},{default:_((()=>[c(p(f),null,{default:_((()=>[c(p(m),null,{default:_((()=>{var e;return[g(h(null===(e=W.value)||void 0===e?void 0:e.name),1)]})),_:1}),c(p(y),null,{default:_((()=>{var e;return[g("$"+h(null===(e=W.value)||void 0===e?void 0:e.price)+" MXN p/noche",1)]})),_:1}),c(p(k)),c(p(w),null,{default:_((()=>[c(p(k),null,{default:_((()=>[c(p(x),null,{default:_((()=>[g("Día de entrada")])),_:1}),c(p(D),{datetime:"datetimeIn"}),c(p(I),{"keep-contents-mounted":!0},{default:_((()=>[c(p(b),{id:"datetimeIn",presentation:"date",value:Y.value.date_in,"format-options":U.value,onIonChange:ae},null,8,["value","format-options"])])),_:1})])),_:1})])),_:1}),c(p(w),null,{default:_((()=>[c(p(k),null,{default:_((()=>[c(p(x),null,{default:_((()=>[g("Día de Salida")])),_:1}),c(p(D),{datetime:"datetimeOut"}),c(p(I),{"keep-contents-mounted":!0},{default:_((()=>[c(p(b),{id:"datetimeOut",presentation:"date",value:Y.value.date_out,"format-options":U.value,onIonChange:ee},null,8,["value","format-options"])])),_:1})])),_:1})])),_:1})])),_:1}),V.value?O("",!0):(r(),C(p($),{key:0,onClick:t[0]||(t[0]=e=>{return a=G.value,void(Z.value?le(a):B.push("/login"));var a}),expand:"block",class:"ion-margin"},{default:_((()=>[g(" Reservar ")])),_:1})),V.value?(r(),C(p($),{key:1,disabled:"",expand:"block",class:"ion-margin"},{default:_((()=>[g(" Revisa las fechas ")])),_:1})):O("",!0),c(p(k),null,{default:_((()=>[c(p(T),{class:"ion-padding-start"},{default:_((()=>[a])),_:1})])),_:1}),c(p(k),null,{default:_((()=>[c(p(M),{size:"6"},{default:_((()=>[c(p(T),{class:"ion-padding-start ion-no-margin text-base"},{default:_((()=>{var e;return[N("u",null,"$"+h(null===(e=W.value)||void 0===e?void 0:e.price)+" MXN x "+h(F.value)+" noches",1)]})),_:1})])),_:1}),c(p(M),{size:"6"},{default:_((()=>[c(p(S),{class:"ion-justify-content-end ion-margin-end"},{default:_((()=>{var e;return[null!==(e=W.value)&&void 0!==e&&e.price&&F.value?(r(),C(p(T),{key:0,class:"ion-no-margin text-base"},{default:_((()=>{var e;return[g("$"+h((null===(e=W.value)||void 0===e?void 0:e.price)*F.value)+" MXN",1)]})),_:1})):V.value?O("",!0):(r(),C(p(T),{key:1},{default:_((()=>[g("???")])),_:1}))]})),_:1})])),_:1})])),_:1}),c(p(k),null,{default:_((()=>[c(p(M),null,{default:_((()=>[c(p(T),{class:"ion-padding-start ion-no-margin text-lg"},{default:_((()=>[P,c(p(X),{icon:p(j)},null,8,["icon"])])),_:1})])),_:1}),c(p(M),null,{default:_((()=>[c(p(S),{class:"ion-justify-content-end ion-margin-end"},{default:_((()=>[W.value&&F.value?(r(),C(p(T),{key:0,class:"ion-no-margin text-base"},{default:_((()=>[g("$"+h(W.value.price*F.value*.1)+" MXN",1)])),_:1})):V.value?O("",!0):(r(),C(p(T),{key:1},{default:_((()=>[g("???")])),_:1}))])),_:1})])),_:1})])),_:1}),c(p(k),null,{default:_((()=>[c(p(M),null,{default:_((()=>[c(p(T),{class:"ion-padding-start"},{default:_((()=>[R])),_:1})])),_:1}),c(p(M),null,{default:_((()=>[c(p(S),{class:"ion-justify-content-end ion-margin-end"},{default:_((()=>[J.value?(r(),C(p(T),{key:0,class:"ion-padding-start text-base"},{default:_((()=>[N("b",null,"$"+h(J.value.toFixed(2)),1)])),_:1})):V.value?O("",!0):(r(),C(p(T),{key:1},{default:_((()=>[g("???")])),_:1}))])),_:1})])),_:1})])),_:1})])),_:1}),c(p(A),{"is-open":K.value,position:"middle",message:"Agrega los días que quieres quedarte","position-anchor":"footer",duration:2e3,onDidDismiss:t[1]||(t[1]=e=>K.value=!1)},null,8,["is-open"])],64))}}))}}}));
