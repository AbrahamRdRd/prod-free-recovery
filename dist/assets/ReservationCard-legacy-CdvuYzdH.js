System.register(["./axios-legacy-CUPSUh8R.js","./index-legacy-C05rGFRK.js","./_plugin-vue_export-helper-legacy-DgAO6S8O.js"],(function(e,a){"use strict";var t,l,n,u,i,o,d,s,r,c,v,p,_,m,f,g,h,y,k,x,w,I,D,b,C,T,O,$,j,M,N,S,X,q,A,R,z,E,P,B;return{setters:[e=>{t=e.a},e=>{l=e.d,n=e.O,u=e.f,i=e.r,o=e.a,d=e.u,s=e.ah,r=e.N,c=e.o,v=e.c,p=e.g,_=e.w,m=e.e,f=e.E,g=e.D,h=e.t,y=e.C,k=e.B,x=e.X,w=e.W,I=e.ac,D=e.ai,b=e.aj,C=e.ag,T=e.b,O=e.s,$=e.T,j=e.ab,M=e.J,N=e.m,S=e.L,X=e.R,q=e.ak,A=e.n,R=e.al,z=e.K,E=e.x,P=e.y},e=>{B=e._}],execute:function(){var a=document.createElement("style");a.textContent=".card-content[data-v-98c60656]{height:min-content}\n",document.head.appendChild(a);const F=e=>(E("data-v-98c60656"),e=e(),P(),e),K=F((()=>N("h2",null,"Detalle de precio",-1))),U=F((()=>N("u",null,"Tarifia de servicio",-1))),H=F((()=>N("b",null,"Total(MXN)",-1)));e("R",B(l({__name:"ReservationCard",props:{departmentInfo:Object},setup(e){const a=n(),l=u(),E=i(0),P=i(),B=i(!0),F=i(!1),L=o((()=>ae.departmentInfo)),V=o((()=>ae.reservation)),Y=i({date:{weekday:"short",month:"long",day:"2-digit"},time:{hour:"2-digit",minute:"2-digit"}}),G=e=>{const a=new Date(e).getUTCDay();return 0!==a&&6!==a},J=i({date_in:(new Date).toISOString().split("T")[0],date_out:new Date((new Date).setDate((new Date).getDate()+1)).toISOString().split("T")[0]}),W=e,Q=i(""),Z=i(),ee=i(),ae=d(),te=o((()=>ae.isLogged)),le=(o((()=>ae.reservation)),e=>{var a;J.value.date_out=null!==(a=e.detail.value)&&void 0!==a?a:"",console.log(e.detail.value)}),ne=e=>{var a;J.value.date_in=null!==(a=e.detail.value)&&void 0!==a?a:""},ue=(e,a)=>{const t=new Date(e),l=new Date(a),n=Math.abs(l.getTime()-t.getTime());if(!(l>t))return Math.ceil(n/864e5);B.value=!0,F.value=!1},ie=async e=>{try{var l;const n=await t.post("https://api.stripe.com/v1/checkout/sessions",{success_url:`http://localhost:5173/departments/${a.params.id}/succes-payment?department=${null===(l=ee.value)||void 0===l?void 0:l.name}&date_in=${J.value.date_in}&date_out=${J.value.date_out}&total=${Z.value}`,cancel_url:`http://localhost:5173/departments/${a.params.id}`,line_items:[{price:e,quantity:P.value}],mode:"payment",payment_method_types:["card"]},{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer sk_test_IKYCHOAmUhC7IPTdaoVtO58D"}});console.log("url_check",n.data.url),ae.setCheckOutId(n.data.id),n.data.url&&(window.location.href=n.data.url)}catch(n){console.error("Error en el checkout",n)}},oe=async e=>{try{const a=await t.post("https://api.stripe.com/v1/prices",{currency:"mxn",unit_amount:100*e,"product_data[name]":"Gold Plan"},{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer sk_test_IKYCHOAmUhC7IPTdaoVtO58D"}});Q.value=a.data.id}catch(a){console.error("No pudimos agregar el precio",a)}},de=()=>{if(ee.value=L.value,E.value=ee.value.price,P.value=ue(J.value.date_out,J.value.date_in),P.value){Z.value=E.value*P.value*1.1;const e=1.1*E.value;oe(parseInt(e.toFixed(2)))}},se=async()=>{if(W.departmentInfo&&(ee.value=W.departmentInfo,E.value=W.departmentInfo.price,P.value=ue(J.value.date_out,J.value.date_in),P.value)){Z.value=E.value*P.value*1.1;const e=1.1*E.value;oe(parseInt(e.toFixed(2)))}};return te.value,s((()=>{a.fullPath.includes("reservation")&&a.query.department?de():se()})),r((()=>[L.value,V.value,J.value.date_in,J.value.date_out]),(e=>{se(),de(),console.log("El valor de date_out ha cambiado a:",e)})),(e,a)=>(c(),v(z,null,[p(m(A),{class:"ion-padding-vertical w-full card-content"},{default:_((()=>[p(m(f),null,{default:_((()=>[p(m(g),{class:"ml-3"},{default:_((()=>{var e;return[h(y(null===(e=ee.value)||void 0===e?void 0:e.name),1)]})),_:1}),p(m(k),{class:"ml-3"},{default:_((()=>{var e;return[h("$"+y(null===(e=ee.value)||void 0===e?void 0:e.price)+" MXN p/noche",1)]})),_:1}),p(m(x)),p(m(w),{class:"p-0"},{default:_((()=>[p(m(x),null,{default:_((()=>[p(m(I),null,{default:_((()=>[h("Día de entrada")])),_:1}),p(m(D),{datetime:"datetimeIn"}),p(m(b),{"keep-contents-mounted":!0},{default:_((()=>[p(m(C),{id:"datetimeIn","is-date-enabled":G,presentation:"date",value:J.value.date_in,"format-options":Y.value,onIonChange:ne},null,8,["value","format-options"])])),_:1})])),_:1})])),_:1}),p(m(w),{class:"p-0"},{default:_((()=>[p(m(x),{lines:"inset"},{default:_((()=>[p(m(I),null,{default:_((()=>[h("Día de Salida")])),_:1}),p(m(D),{datetime:"datetimeOut"}),p(m(b),{"keep-contents-mounted":!0},{default:_((()=>[p(m(C),{id:"datetimeOut",presentation:"date",value:J.value.date_out,"format-options":Y.value,onIonChange:le},null,8,["value","format-options"])])),_:1})])),_:1})])),_:1})])),_:1}),F.value?$("",!0):(c(),T(m(O),{key:0,onClick:a[0]||(a[0]=e=>{return a=Q.value,void(te.value?ie(a):l.push("/login"));var a}),class:"mx-5",expand:"block"},{default:_((()=>[h(" Reservar ")])),_:1})),F.value?(c(),T(m(O),{key:1,disabled:"",expand:"block",class:"ion-margin"},{default:_((()=>[h(" Revisa las fechas ")])),_:1})):$("",!0),p(m(x),{lines:"inset"},{default:_((()=>[p(m(j),{class:"ion-padding-start"},{default:_((()=>[K])),_:1})])),_:1}),p(m(x),{lines:"inset"},{default:_((()=>[p(m(M),{size:"6"},{default:_((()=>[p(m(j),{class:"ion-padding-start ion-no-margin text-base"},{default:_((()=>{var e;return[N("u",null,"$"+y(null===(e=ee.value)||void 0===e?void 0:e.price)+" MXN x "+y(P.value)+" noches",1)]})),_:1})])),_:1}),p(m(M),{size:"6"},{default:_((()=>[p(m(S),{class:"ion-justify-content-end ion-margin-end"},{default:_((()=>{var e;return[null!==(e=ee.value)&&void 0!==e&&e.price&&P.value?(c(),T(m(j),{key:0,class:"ion-no-margin text-base"},{default:_((()=>{var e;return[h("$"+y((null===(e=ee.value)||void 0===e?void 0:e.price)*P.value)+" MXN",1)]})),_:1})):F.value?$("",!0):(c(),T(m(j),{key:1},{default:_((()=>[h("???")])),_:1}))]})),_:1})])),_:1})])),_:1}),p(m(x),{lines:"inset"},{default:_((()=>[p(m(M),null,{default:_((()=>[p(m(j),{class:"ion-padding-start ion-no-margin text-lg"},{default:_((()=>[U,p(m(X),{icon:m(q)},null,8,["icon"])])),_:1})])),_:1}),p(m(M),null,{default:_((()=>[p(m(S),{class:"ion-justify-content-end ion-margin-end"},{default:_((()=>[ee.value&&P.value?(c(),T(m(j),{key:0,class:"ion-no-margin text-base"},{default:_((()=>[h("$"+y(ee.value.price*P.value*.1)+" MXN",1)])),_:1})):F.value?$("",!0):(c(),T(m(j),{key:1},{default:_((()=>[h("???")])),_:1}))])),_:1})])),_:1})])),_:1}),p(m(x),{lines:"inset"},{default:_((()=>[p(m(M),null,{default:_((()=>[p(m(j),{class:"ion-padding-start"},{default:_((()=>[H])),_:1})])),_:1}),p(m(M),null,{default:_((()=>[p(m(S),{class:"ion-justify-content-end ion-margin-end"},{default:_((()=>[Z.value?(c(),T(m(j),{key:0,class:"ion-padding-start text-base"},{default:_((()=>[N("b",null,"$"+y(Z.value.toFixed(2)),1)])),_:1})):F.value?$("",!0):(c(),T(m(j),{key:1},{default:_((()=>[h("???")])),_:1}))])),_:1})])),_:1})])),_:1})])),_:1}),p(m(R),{"is-open":B.value,position:"middle",message:"Agrega los días que quieres quedarte","position-anchor":"footer",duration:2e3,onDidDismiss:a[1]||(a[1]=e=>B.value=!1)},null,8,["is-open"])],64))}}),[["__scopeId","data-v-98c60656"]]))}}}));
