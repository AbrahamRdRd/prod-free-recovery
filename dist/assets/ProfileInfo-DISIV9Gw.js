import{d as X,r as f,u as Y,a as Q,aj as te,o as i,c as B,g as l,w as a,e,I as Z,h as q,s as y,t as c,z as ee,k as le,m as E,W as p,q as k,aF as R,K as D,H as K,b as g,aG as M,C as T,X as C,v as ae,aH as W,f as ne,a0 as ue,i as se,aa as re,n as de,L as ie,P as ce,V as me,R as V,aI as h,aJ as fe,aK as pe,l as ve,x as ye,y as ke}from"./index-b4t3Mdji.js";import{u as oe,g as _e}from"./user-BvSx9lCV.js";import{h as G}from"./https-SOK1QiRA.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./axios-CwoVb0Lo.js";const be=()=>G.get("/api/countries"),Ie=_=>G.get("/api/countries/".concat(_,"/states")),Ve=_=>G.get("/api/states/".concat(_,"/cities")),Ce=X({__name:"ModalProfile",props:{userId:Object,avatar:File},setup(_){var o,u;f();const s=f({id:0,email:"",name:"",first_name:"",second_name:"",password:"",role_id:0,city_id:0,deleted_at:null}),U=_,H=()=>W.dismiss(null,"cancel"),d=Y(),I=f(),S=f(),$=f(),w=f(),v=f(),N=f();Q(()=>JSON.parse(d.userInfo)),s.value=U.userId,console.log("request.value ",s.value),I.value=(o=s.value.city)==null?void 0:o.state.country_id,S.value=(u=s.value.city)==null?void 0:u.state_id,v.value=s.value.city_id;const O=async()=>{try{const r=(await be()).data;$.value=r.data}catch(r){console.error("Hubo un error al traer las ciudades")}},j=async r=>{try{const n=(await Ie(r)).data;w.value=n.data}catch(n){console.error("Hubo un error al traer los estados")}},z=async r=>{try{const n=(await Ve(r)).data;N.value=n.data}catch(n){console.log("Hubo un error en al traer las ciudades")}},x=r=>{console.log("Selected country ID:",r.detail.value),j(r.detail.value)},A=r=>{console.log("Selected State ID:",r.detail.value),z(r.detail.value)},J=r=>{console.log("Selected City ID:",r.detail.value),s.value.city_id=r.detail.value},m=async()=>{var t,b;const r={email:s.value.email,name:s.value.name,first_name:s.value.first_name,second_name:s.value.second_name,phone:s.value.phone,city_id:s.value.city_id,image:U.avatar},n=new FormData;for(const F in r)if(Object.prototype.hasOwnProperty.call(r,F)){const L=F,P=r[L];P instanceof File?n.append(L,P):n.append(L,(t=P==null?void 0:P.toString())!=null?t:"")}try{const F=(await oe((b=U.userId)==null?void 0:b.id,n)).data;W.dismiss("confirm")}catch(F){console.error("Algo salio mal al actualizar.")}};return te(()=>{O()}),(r,n)=>(i(),B(D,null,[l(e(le),null,{default:a(()=>[l(e(Z),null,{default:a(()=>[l(e(q),{slot:"start"},{default:a(()=>[l(e(y),{color:"medium",onClick:H},{default:a(()=>[c("Cancel")]),_:1})]),_:1}),l(e(ee),null,{default:a(()=>[c("Actualiza tú información")]),_:1}),l(e(q),{slot:"end"},{default:a(()=>[l(e(y),{onClick:m,strong:!0},{default:a(()=>[c("Confirm")]),_:1})]),_:1})]),_:1})]),_:1}),l(e(ae),{class:"ion-padding"},{default:a(()=>[E("form",{onSubmit:m},[l(e(p),null,{default:a(()=>[l(e(k),{"label-placement":"stacked",label:"Cambia tu nombre(s)",modelValue:s.value.name,"onUpdate:modelValue":n[0]||(n[0]=t=>s.value.name=t),placeholder:"Your name"},null,8,["modelValue"])]),_:1}),l(e(p),null,{default:a(()=>[l(e(k),{"label-placement":"stacked",label:"Cambia tu primer apellido",modelValue:s.value.first_name,"onUpdate:modelValue":n[1]||(n[1]=t=>s.value.first_name=t),placeholder:"Your second name"},null,8,["modelValue"])]),_:1}),l(e(p),null,{default:a(()=>[l(e(k),{"label-placement":"stacked",label:"Cambia tu segundo apellido",modelValue:s.value.second_name,"onUpdate:modelValue":n[2]||(n[2]=t=>s.value.second_name=t),placeholder:"Your last name"},null,8,["modelValue"])]),_:1}),l(e(p),null,{default:a(()=>[l(e(k),{"label-placement":"stacked",label:"Cambia tu cuenta de email",modelValue:s.value.email,"onUpdate:modelValue":n[3]||(n[3]=t=>s.value.email=t),placeholder:"Your email"},null,8,["modelValue"])]),_:1}),l(e(p),null,{default:a(()=>[l(e(k),{"label-placement":"stacked",label:"Cambia tu telefono",modelValue:s.value.phone,"onUpdate:modelValue":n[4]||(n[4]=t=>s.value.phone=t),placeholder:"(+52) 888-88-88"},null,8,["modelValue"])]),_:1}),l(e(p),{lines:"none"},{default:a(()=>[l(e(R),{modelValue:I.value,"onUpdate:modelValue":n[5]||(n[5]=t=>I.value=t),onIonChange:x,class:"mt-3 mr-2",label:"País","label-placement":"floating",fill:"outline"},{default:a(()=>[(i(!0),B(D,null,K($.value,t=>(i(),g(e(M),{value:t.id},{default:a(()=>[c(T(t.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"]),S.value?(i(),g(e(R),{key:0,modelValue:S.value,"onUpdate:modelValue":n[6]||(n[6]=t=>S.value=t),onIonChange:A,class:"mt-3 mr-2",label:"Estado","label-placement":"floating",fill:"outline"},{default:a(()=>[(i(!0),B(D,null,K(w.value,t=>(i(),g(e(M),{value:t.id},{default:a(()=>[c(T(t.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])):C("",!0),v.value?(i(),g(e(R),{key:1,modelValue:v.value,"onUpdate:modelValue":n[7]||(n[7]=t=>v.value=t),onIonChange:J,class:"mt-3",label:"Ciudad","label-placement":"floating",fill:"outline"},{default:a(()=>[(i(!0),B(D,null,K(N.value,t=>(i(),g(e(M),{value:t.id},{default:a(()=>[c(T(t.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])):C("",!0)]),_:1})],32)]),_:1})],64))}}),Se=_=>(ye("data-v-ced7d1d4"),_=_(),ke(),_),we={class:"h-full flex flex-column justify-content-center align-items-center"},he=["src"],Ue=Se(()=>E("img",{class:"border-circle",alt:"Silhouette of a person's head",src:"https://ionicframework.com/docs/img/demos/avatar.svg"},null,-1)),xe=X({__name:"ProfileInfo",setup(_){const s=Y(),U=Q(()=>s.userInfo),H=JSON.parse(U.value),d=f({deleted_at:null}),I=f(!1),S=Y(),$=ne(),w=f(!1),v=async()=>{const m=await W.create({component:Ce,componentProps:{userId:d.value,avatar:O.value}});m.present();const{data:o,role:u}=await m.onWillDismiss();o==="confirm"&&await A()},N=()=>{document.getElementById("file-upload").click()},O=f(),j=m=>{const o=m.target.files[0];O.value=o,J(o)},z=()=>{S.logout(),w.value=!0,setTimeout(()=>{$.replace("/")},3e3)},x=f(),A=async()=>{var m,o;try{d.value=(await _e(H.id)).data,console.log("NAME",(m=d.value.city)==null?void 0:m.state.country),x.value=(o=d.value.city)==null?void 0:o.state.country.name}catch(u){console.error("Hubo un errror al traer la información del usuario.")}},J=async m=>{var r;const o={...d.value,avatar:m},u=new FormData;for(const n in o)if(Object.prototype.hasOwnProperty.call(o,n)){const t=n,b=o[t];b instanceof File?u.append(t,b):u.append(t,(r=b==null?void 0:b.toString())!=null?r:"")}try{await oe(d.value.id,u)}catch(n){console.error("Algo salio mal al actualizar.")}};return ue(()=>{A()}),(m,o)=>(i(),B(D,null,[l(e(le),null,{default:a(()=>[l(e(Z),null,{default:a(()=>[l(e(q),{slot:"start"},{default:a(()=>[l(e(se),{defaultHref:"/departments",icon:e(re)},null,8,["icon"])]),_:1}),l(e(ee),null,{default:a(()=>[c("Perfil personal")]),_:1})]),_:1})]),_:1}),l(e(ve),null,{default:a(()=>[l(e(ae),null,{default:a(()=>[E("div",we,[l(e(de),{class:"mb-6 w-full md:w-30rem"},{default:a(()=>[l(e(ie),{class:"flex justify-content-center mt-5"},{default:a(()=>[d.value.avatar?(i(),g(e(ce),{key:0},{default:a(()=>[E("img",{alt:"Silhouette of a person's head",src:d.value.avatar},null,8,he)]),_:1})):C("",!0),d.value.avatar?C("",!0):(i(),g(e(y),{key:1,class:"w-2 h-2",onClick:N,size:"large",fill:"outline",color:"dark"},{default:a(()=>[E("input",{type:"file",id:"file-upload",style:{display:"none"},onChange:j},null,32),Ue]),_:1}))]),_:1}),l(e(me),{class:"mt-5"},{default:a(()=>[l(e(p),null,{default:a(()=>[l(e(k),{label:"Nombre(s):",placeholder:"Jonh",modelValue:d.value.name,"onUpdate:modelValue":o[0]||(o[0]=u=>d.value.name=u),"label-placement":"stacked",readonly:""},null,8,["modelValue"]),l(e(y),{fill:"outline",color:"dark",onClick:o[1]||(o[1]=u=>v())},{default:a(()=>[c(" Edit "),l(e(V),{slot:"end",icon:e(h),color:"dark"},null,8,["icon"])]),_:1})]),_:1}),l(e(p),null,{default:a(()=>[l(e(k),{label:"Primer apellido:",placeholder:"Cena",modelValue:d.value.first_name,"onUpdate:modelValue":o[2]||(o[2]=u=>d.value.first_name=u),"label-placement":"stacked",readonly:""},null,8,["modelValue"]),l(e(y),{fill:"outline",color:"dark",onClick:o[3]||(o[3]=u=>v())},{default:a(()=>[c(" Edit "),l(e(V),{slot:"end",icon:e(h),color:"dark"},null,8,["icon"])]),_:1})]),_:1}),l(e(p),null,{default:a(()=>[l(e(k),{label:"Segundo apellido:",placeholder:"Rodríguez",modelValue:d.value.second_name,"onUpdate:modelValue":o[4]||(o[4]=u=>d.value.second_name=u),"label-placement":"stacked",readonly:""},null,8,["modelValue"]),l(e(y),{fill:"outline",color:"dark",onClick:o[5]||(o[5]=u=>v())},{default:a(()=>[c(" Edit "),l(e(V),{slot:"end",icon:e(h),color:"dark"},null,8,["icon"])]),_:1})]),_:1}),l(e(p),null,{default:a(()=>[l(e(k),{label:"email",placeholder:"email@email.com",modelValue:d.value.email,"onUpdate:modelValue":o[6]||(o[6]=u=>d.value.email=u),"label-placement":"stacked",readonly:!I.value},null,8,["modelValue","readonly"]),I.value?C("",!0):(i(),g(e(y),{key:0,fill:"outline",color:"dark",onClick:o[7]||(o[7]=u=>v())},{default:a(()=>[c(" Edit "),l(e(V),{slot:"end",icon:e(h),color:"dark"},null,8,["icon"])]),_:1})),I.value?(i(),g(e(y),{key:1,fill:"outline",color:"dark"},{default:a(()=>[c(" Save "),l(e(V),{slot:"end",icon:e(fe),color:"dark"},null,8,["icon"])]),_:1})):C("",!0)]),_:1}),l(e(p),null,{default:a(()=>[l(e(k),{label:"Phone",placeholder:"(+52) 888-888-88-88",modelValue:d.value.phone,"onUpdate:modelValue":o[8]||(o[8]=u=>d.value.phone=u),"label-placement":"stacked",readonly:""},null,8,["modelValue"]),l(e(y),{fill:"outline",color:"dark",onClick:o[9]||(o[9]=u=>v())},{default:a(()=>[c(" Edit "),l(e(V),{slot:"end",icon:e(h),color:"dark"},null,8,["icon"])]),_:1})]),_:1}),l(e(p),null,{default:a(()=>[l(e(k),{label:"País",placeholder:"your country",modelValue:x.value,"onUpdate:modelValue":o[10]||(o[10]=u=>x.value=u),"label-placement":"stacked",readonly:""},null,8,["modelValue"]),l(e(y),{fill:"outline",color:"dark",onClick:o[11]||(o[11]=u=>v())},{default:a(()=>[c(" Edit "),l(e(V),{slot:"end",icon:e(h),color:"dark"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),l(e(y),{onClick:z,class:"px-1 w-full md:w-30rem",expand:"block",fill:"outline",color:"dark"},{default:a(()=>[c("Cerrar Sesión")]),_:1}),w.value?(i(),g(e(pe),{key:0,"is-open":w.value,message:"Cerrando sessión...",spinner:"circles"},null,8,["is-open"])):C("",!0)])]),_:1})]),_:1})],64))}}),Ne=ge(xe,[["__scopeId","data-v-ced7d1d4"]]);export{Ne as default};
