System.register(["./axios-legacy-CUPSUh8R.js","./ionicons-legacy-BYlXq-Bl.js","./@ionic-legacy-By4cGjyB.js","./vue-router-legacy-BXDKlxlV.js","./index-legacy-ax7x2NGG.js","./@vue-legacy-D0SgPP5D.js","./_plugin-vue_export-helper-legacy-DgAO6S8O.js"],(function(e,a){"use strict";var t,l,n,u,i,o,d,s,r,c,v,p,_,m,f,g,y,h,x,k,w,I,D,b,C,$,j,O,T,M,N,q,S,z,A,P,X,H,R,B;return{setters:[e=>{t=e.a},e=>{l=e.i},e=>{n=e.u,u=e.z,i=e.y,o=e.x,d=e.v,s=e.H,r=e.e,c=e.M,v=e.N,p=e.L,_=e.l,m=e.k,f=e.B,g=e.C,y=e.d,h=e.q,x=e.O},e=>{k=e.u},e=>{w=e.u},e=>{I=e.d,D=e.r,b=e.c,C=e.aG,$=e.w,j=e.aM,O=e.a1,T=e.aa,M=e.by,N=e.be,q=e.a9,S=e.b7,z=e.$,A=e.a0,P=e.a2,X=e.H,H=e.aP,R=e.aN},e=>{B=e._}],execute:function(){var a=document.createElement("style");a.textContent=".card-content[data-v-0fc73287]{height:min-content}\n",document.head.appendChild(a);const F=e=>(H("data-v-0fc73287"),e=e(),R(),e),U=F((()=>P("h2",null,"Detalle de precio",-1))),E=F((()=>P("u",null,"Tarifia de servicio",-1))),G=F((()=>P("b",null,"Total(MXN)",-1)));e("R",B(I({__name:"ReservationCard",props:{departmentInfo:Object},setup(e){const a=k(),I=n(),H=D(0),R=D(),B=D(!0),F=D(!1),K=b((()=>ae.departmentInfo)),L=b((()=>ae.reservation)),V=D({date:{weekday:"short",month:"long",day:"2-digit"},time:{hour:"2-digit",minute:"2-digit"}}),Y=e=>{const a=new Date(e).getUTCDay();return 0!==a&&6!==a},J=D({date_in:(new Date).toISOString().split("T")[0],date_out:new Date((new Date).setDate((new Date).getDate()+1)).toISOString().split("T")[0]}),Q=e,W=D(""),Z=D(),ee=D(),ae=w(),te=b((()=>ae.isLogged)),le=(b((()=>ae.reservation)),e=>{var a;J.value.date_out=null!==(a=e.detail.value)&&void 0!==a?a:""}),ne=e=>{var a;J.value.date_in=null!==(a=e.detail.value)&&void 0!==a?a:""},ue=(e,a)=>{const t=new Date(e),l=new Date(a),n=Math.abs(l.getTime()-t.getTime());if(!(l>t))return Math.ceil(n/864e5);B.value=!0,F.value=!1},ie=async e=>{try{var l;const n=await t.post("https://api.stripe.com/v1/checkout/sessions",{success_url:`http://localhost:5173/departments/${a.params.id}/succes-payment?department=${null===(l=ee.value)||void 0===l?void 0:l.name}&date_in=${J.value.date_in}&date_out=${J.value.date_out}&total=${Z.value}`,cancel_url:`http://localhost:5173/departments/${a.params.id}`,line_items:[{price:e,quantity:R.value}],mode:"payment",payment_method_types:["card"]},{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer sk_test_IKYCHOAmUhC7IPTdaoVtO58D"}});ae.setCheckOutId(n.data.id),n.data.url&&(window.location.href=n.data.url)}catch(n){console.error("Error en el checkout",n)}},oe=async e=>{try{const a=await t.post("https://api.stripe.com/v1/prices",{currency:"mxn",unit_amount:100*e,"product_data[name]":"Gold Plan"},{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer sk_test_IKYCHOAmUhC7IPTdaoVtO58D"}});W.value=a.data.id}catch(a){console.error("No pudimos agregar el precio",a)}},de=()=>{if(ee.value=K.value,H.value=ee.value.price,R.value=ue(J.value.date_out,J.value.date_in),R.value){Z.value=H.value*R.value*1.1;const e=1.1*H.value;oe(parseInt(e.toFixed(2)))}},se=async()=>{if(Q.departmentInfo&&(ee.value=Q.departmentInfo,H.value=Q.departmentInfo.price,R.value=ue(J.value.date_out,J.value.date_in),R.value)){Z.value=H.value*R.value*1.1;const e=1.1*H.value;oe(parseInt(e.toFixed(2)))}};return te.value,C((()=>{a.fullPath.includes("reservation")&&a.query.department?de():se()})),$((()=>[K.value,L.value,J.value.date_in,J.value.date_out]),(e=>{se(),de()})),(e,a)=>(j(),O(X,null,[T(N(h),{class:"ion-padding-vertical w-full card-content"},{default:M((()=>[T(N(u),null,{default:M((()=>[T(N(i),{class:"ml-3"},{default:M((()=>{var e;return[q(S(null===(e=ee.value)||void 0===e?void 0:e.name),1)]})),_:1}),T(N(o),{class:"ml-3"},{default:M((()=>{var e;return[q("$"+S(null===(e=ee.value)||void 0===e?void 0:e.price)+" MXN p/noche",1)]})),_:1}),T(N(d)),T(N(s),{class:"p-0"},{default:M((()=>[T(N(d),null,{default:M((()=>[T(N(r),null,{default:M((()=>[q("Día de entrada")])),_:1}),T(N(c),{datetime:"datetimeIn"}),T(N(v),{"keep-contents-mounted":!0},{default:M((()=>[T(N(p),{id:"datetimeIn","is-date-enabled":Y,presentation:"date",value:J.value.date_in,"format-options":V.value,onIonChange:ne},null,8,["value","format-options"])])),_:1})])),_:1})])),_:1}),T(N(s),{class:"p-0"},{default:M((()=>[T(N(d),{lines:"inset"},{default:M((()=>[T(N(r),null,{default:M((()=>[q("Día de Salida")])),_:1}),T(N(c),{datetime:"datetimeOut"}),T(N(v),{"keep-contents-mounted":!0},{default:M((()=>[T(N(p),{id:"datetimeOut",presentation:"date",value:J.value.date_out,"format-options":V.value,onIonChange:le},null,8,["value","format-options"])])),_:1})])),_:1})])),_:1})])),_:1}),F.value?A("",!0):(j(),z(N(_),{key:0,onClick:a[0]||(a[0]=e=>{return a=W.value,void(te.value?ie(a):I.push("/login"));var a}),class:"mx-5",expand:"block"},{default:M((()=>[q(" Reservar ")])),_:1})),F.value?(j(),z(N(_),{key:1,disabled:"",expand:"block",class:"ion-margin"},{default:M((()=>[q(" Revisa las fechas ")])),_:1})):A("",!0),T(N(d),{lines:"inset"},{default:M((()=>[T(N(m),{class:"ion-padding-start"},{default:M((()=>[U])),_:1})])),_:1}),T(N(d),{lines:"inset"},{default:M((()=>[T(N(f),{size:"6"},{default:M((()=>[T(N(m),{class:"ion-padding-start ion-no-margin text-base"},{default:M((()=>{var e;return[P("u",null,"$"+S(null===(e=ee.value)||void 0===e?void 0:e.price)+" MXN x "+S(R.value)+" noches",1)]})),_:1})])),_:1}),T(N(f),{size:"6"},{default:M((()=>[T(N(g),{class:"ion-justify-content-end ion-margin-end"},{default:M((()=>{var e;return[null!==(e=ee.value)&&void 0!==e&&e.price&&R.value?(j(),z(N(m),{key:0,class:"ion-no-margin text-base"},{default:M((()=>{var e;return[q("$"+S((null===(e=ee.value)||void 0===e?void 0:e.price)*R.value)+" MXN",1)]})),_:1})):F.value?A("",!0):(j(),z(N(m),{key:1},{default:M((()=>[q("???")])),_:1}))]})),_:1})])),_:1})])),_:1}),T(N(d),{lines:"inset"},{default:M((()=>[T(N(f),null,{default:M((()=>[T(N(m),{class:"ion-padding-start ion-no-margin text-lg"},{default:M((()=>[E,T(N(y),{icon:N(l)},null,8,["icon"])])),_:1})])),_:1}),T(N(f),null,{default:M((()=>[T(N(g),{class:"ion-justify-content-end ion-margin-end"},{default:M((()=>[ee.value&&R.value?(j(),z(N(m),{key:0,class:"ion-no-margin text-base"},{default:M((()=>[q("$"+S(ee.value.price*R.value*.1)+" MXN",1)])),_:1})):F.value?A("",!0):(j(),z(N(m),{key:1},{default:M((()=>[q("???")])),_:1}))])),_:1})])),_:1})])),_:1}),T(N(d),{lines:"inset"},{default:M((()=>[T(N(f),null,{default:M((()=>[T(N(m),{class:"ion-padding-start"},{default:M((()=>[G])),_:1})])),_:1}),T(N(f),null,{default:M((()=>[T(N(g),{class:"ion-justify-content-end ion-margin-end"},{default:M((()=>[Z.value?(j(),z(N(m),{key:0,class:"ion-padding-start text-base"},{default:M((()=>[P("b",null,"$"+S(Z.value.toFixed(2)),1)])),_:1})):F.value?A("",!0):(j(),z(N(m),{key:1},{default:M((()=>[q("???")])),_:1}))])),_:1})])),_:1})])),_:1})])),_:1}),T(N(x),{"is-open":B.value,position:"middle",message:"Agrega los días que quieres quedarte","position-anchor":"footer",duration:2e3,onDidDismiss:a[1]||(a[1]=e=>B.value=!1)},null,8,["is-open"])],64))}}),[["__scopeId","data-v-0fc73287"]]))}}}));
