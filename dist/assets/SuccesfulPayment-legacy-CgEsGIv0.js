System.register(["./@ionic-legacy-CbonVIpO.js","./ionicons-legacy-HQMOYMzb.js","./index-legacy-D92_TgYs.js","./vue-router-legacy-BXDKlxlV.js","./departmentReservation-legacy-ClE7VcnB.js","./axios-legacy-CUPSUh8R.js","./@vue-legacy-D0SgPP5D.js","./@stencil-legacy-CapHDfm8.js","./pinia-legacy-DXNVVc9U.js","./crypto-js-legacy-DI2495am.js","./register-service-worker-legacy-OLieyxJW.js","./primeflex-legacy-BopLd2K7.js","./https-legacy-CY25jbHb.js","./vue-toast-notification-legacy-CcnPxyzq.js","./vue-legacy-CAYYIPah.js"],(function(e,t){"use strict";var a,l,n,s,o,u,r,c,i,d,m,f,y,p,_,g,x,h,v,b,j,w,C,k,A,N,S,z,Z,$,O,q,D;return{setters:[e=>{a=e.m,l=e.n,n=e.l,s=e.d,o=e.A,u=e.p,r=e.w,c=e.D,i=e.k,d=e.r,m=e.x,f=e.e,y=e.q,p=e.g},e=>{_=e.b},e=>{g=e.u},e=>{x=e.u,h=e.b},e=>{v=e.c},e=>{b=e.a},e=>{j=e.d,w=e.c,C=e.r,k=e.aG,A=e.$,N=e.by,S=e.be,z=e.aM,Z=e.aa,$=e.a9,O=e.b7,q=e.a0,D=e.a2},null,null,null,null,null,null,null,null],execute:function(){const t=D("img",{loading:"lazy",class:"mt-5",width:"100",height:"100",src:"https://i.imgur.com/oSAQEvV.png",alt:"instagram-check-mark"},null,-1),I={class:"mt-3 mb-2 mx-4"};e("default",j({__name:"SuccesfulPayment",setup(e){var j,T;const P=x(),B=h(),V=g(),E=w((()=>V.departmentInfo)),F=w((()=>V.userInfo)).value,M=C(),Y=C(),U=P.query,G=P.query.total,H=Number(G).toFixed(2),J=P.params.id;M.value=E.value;const R=[{type:"body",parameters:[{type:"text",text:U.date_in},{type:"text",text:U.date_out},{type:"text",text:(()=>{const e=new Date(U.date_in);return(new Date(U.date_out).getTime()-e.getTime())/864e5})()},{type:"text",text:null===(j=Number(U.total))||void 0===j?void 0:j.toFixed(2)},{type:"text",text:"Ana Ramirez"},{type:"text",text:`${F.name} ${F.first_name}`},{type:"text",text:F.email},{type:"text",text:`+(${null===(T=F.country_code)||void 0===T?void 0:T.phone_code}) ${F.phone}`}]}],X=async e=>{try{const t=await b.get(`https://api.stripe.com/v1/checkout/sessions/${e}`,{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer sk_test_IKYCHOAmUhC7IPTdaoVtO58D"}});200!==t.status&&201!==t.status||localStorage.getItem(`messageSent_${e}`)||(await(async(e,t,a,l)=>{try{return await b.post(`https://graph.facebook.com/v20.0/${e}/messages`,{messaging_product:"whatsapp",to:t,type:"template",template:{name:a,language:{code:"en"},components:l}},{headers:{Authorization:"Bearer EAAOpEMJaH6ABO6txyRi221NLiwVFbWVUK914IpBFhUnY3RdrSrWCZCONsnyD0tNsOsu1SN3ncZCA7Ni3OuiP833zGxOVJGPZA0r1lZBep6DbhU9k7I5zdCEtHviXlrIZBcXVp8J8WLTYCa5q5P2CZAZCoofjzz9pxY41MOtVUrY5Fl3zEBu9cZASMmTgoFDZCqgHvmAZDZD","Content-Type":"application/json"}})}catch(n){console.error("Error:",n)}})(360628943808363,528131376584,"notification_of_apartment_rental",R),localStorage.setItem(`messageSent_${e}`,"true")),Y.value=t.data,(async(e,t)=>{const a={payment_data:t,date_in:e.date_in,date_out:e.date_out};try{await v(Number(J),a)}catch(l){console.error("No pudimos crear tu reservaciÃ³n")}})(P.query,JSON.stringify(Y.value))}catch(t){console.error("There was an error retrieving the information.",t)}};return k((()=>{const e=w((()=>V.checkout_id));X(e.value)})),(e,g)=>(z(),A(S(p),null,{default:N((()=>[Z(S(u),null,{default:N((()=>[Z(S(a),null,{default:N((()=>[Z(S(l),{slot:"start"},{default:N((()=>[Z(S(n),{"router-link":"/departments"},{default:N((()=>[Z(S(s),{icon:S(_),size:"arge"},null,8,["icon"])])),_:1})])),_:1}),Z(S(o),null,{default:N((()=>[$("Payment confirmation")])),_:1})])),_:1})])),_:1}),Z(S(y),{class:"flex justify-content-center"},{default:N((()=>[Z(S(r),{class:"flex flex-column justify-content-center align-items-center pt-5 min-w-100"},{default:N((()=>[Z(S(c),{class:"flex flex-column align-items-center"},{default:N((()=>[t,Z(S(i),{class:"text-4xl line-height-4 font-semibold"},{default:N((()=>[$("Payment successful")])),_:1}),Z(S(i),null,{default:N((()=>[$("You're closer to fulfilling your dreams.")])),_:1})])),_:1}),Z(S(d),{class:"flex flex-column max-h-auto w-11 mt-5"},{default:N((()=>[Z(S(m),{lines:"none",class:"mt-3 mx-4"},{default:N((()=>[Z(S(f),{class:"font-bold"},{default:N((()=>[$("Site")])),_:1}),Z(S(i),null,{default:N((()=>[$(O(S(P).query.department),1)])),_:1})])),_:1}),Z(S(m),{lines:"none",class:"mt-2 mx-4"},{default:N((()=>[Z(S(f),{class:"font-bold"},{default:N((()=>[$("Check in:")])),_:1}),Z(S(i),null,{default:N((()=>[$(O(S(P).query.date_in),1)])),_:1})])),_:1}),Z(S(m),{lines:"none",class:"mt-2 mx-4"},{default:N((()=>[Z(S(f),{class:"font-bold"},{default:N((()=>[$("Check out:")])),_:1}),Z(S(i),null,{default:N((()=>[$(O(S(P).query.date_out),1)])),_:1})])),_:1}),Z(S(m),{class:"mt-2 mx-4"},{default:N((()=>[Z(S(f),{class:"font-bold"},{default:N((()=>[$("Price per night:")])),_:1}),M.value.price?(z(),A(S(i),{key:0},{default:N((()=>[$("$"+O(M.value.price)+" MXN",1)])),_:1})):q("",!0)])),_:1}),D("div",I,[Z(S(m),{lines:"none"},{default:N((()=>[Z(S(f),{class:"font-bold"},{default:N((()=>[$("Total amount (includes charges):")])),_:1}),Z(S(i),null,{default:N((()=>[$("$"+O(S(H))+" MXN",1)])),_:1})])),_:1})])])),_:1}),Z(S(n),{class:"mt-6",onClick:g[0]||(g[0]=e=>S(B).push("/my-reservations"))},{default:N((()=>[$("Go to my reservations")])),_:1})])),_:1})])),_:1})])),_:1}))}}))}}}));
