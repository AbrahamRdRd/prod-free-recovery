System.register(["./axios-legacy-CUPSUh8R.js","./ionicons-legacy-BYlXq-Bl.js","./@ionic-legacy-CAWqWNAi.js","./vue-router-legacy-BXDKlxlV.js","./index-legacy-CTO43FBS.js","./@vue-legacy-D0SgPP5D.js","./_plugin-vue_export-helper-legacy-DgAO6S8O.js"],(function(e,a){"use strict";var t,l,n,u,o,i,d,s,r,c,v,p,_,m,f,g,y,h,x,k,w,I,D,b,C,T,$,j,O,M,N,A,P,S,q,X,z,E,R,B;return{setters:[e=>{t=e.a},e=>{l=e.i},e=>{n=e.u,u=e.C,o=e.B,i=e.A,d=e.v,s=e.K,r=e.e,c=e.O,v=e.x,p=e.N,_=e.l,m=e.k,f=e.t,g=e.E,y=e.d,h=e.r,x=e.P},e=>{k=e.u},e=>{w=e.u},e=>{I=e.d,D=e.r,b=e.c,C=e.aG,T=e.w,$=e.aM,j=e.a1,O=e.aa,M=e.by,N=e.be,A=e.a9,P=e.b7,S=e.$,q=e.a0,X=e.a2,z=e.H,E=e.aP,R=e.aN},e=>{B=e._}],execute:function(){var a=document.createElement("style");a.textContent=".card-content[data-v-53e10cf6]{height:min-content}\n",document.head.appendChild(a);const F=e=>(E("data-v-53e10cf6"),e=e(),R(),e),H=F((()=>X("h2",null,"Detalle de precio",-1))),K=F((()=>X("u",null,"Tarifia de servicio",-1))),U=F((()=>X("b",null,"Total(MXN)",-1)));e("R",B(I({__name:"ReservationCard",props:{departmentInfo:Object},setup(e){const a=k(),I=n(),E=D(0),R=D(),B=D(!0),F=D(!1),G=b((()=>ae.departmentInfo)),V=b((()=>ae.reservation)),Y=D({date:{weekday:"short",month:"long",day:"2-digit"},time:{hour:"2-digit",minute:"2-digit"}}),L=e=>{const a=new Date(e).getUTCDay();return 0!==a&&6!==a},J=D({date_in:(new Date).toISOString().split("T")[0],date_out:new Date((new Date).setDate((new Date).getDate()+1)).toISOString().split("T")[0]}),Q=e,W=D(""),Z=D(),ee=D(),ae=w(),te=b((()=>ae.isLogged)),le=(b((()=>ae.reservation)),(e,a)=>{const t=new Date(e),l=new Date(a),n=Math.abs(l.getTime()-t.getTime());if(!(l>t))return Math.ceil(n/864e5);B.value=!0,F.value=!1}),ne=async e=>{try{var l;const n=await t.post("https://api.stripe.com/v1/checkout/sessions",{success_url:`recovery-suites.com/departments/${a.params.id}/succes-payment?department=${null===(l=ee.value)||void 0===l?void 0:l.name}&date_in=${J.value.date_in}&date_out=${J.value.date_out}&total=${Z.value}`,cancel_url:`recovery-suites.com/departments/${a.params.id}`,line_items:[{price:e,quantity:R.value}],mode:"payment",payment_method_types:["card"]},{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer sk_test_IKYCHOAmUhC7IPTdaoVtO58D"}});ae.setCheckOutId(n.data.id),n.data.url&&(window.location.href=n.data.url)}catch(n){console.error("Error en el checkout",n)}},ue=async e=>{try{const a=await t.post("https://api.stripe.com/v1/prices",{currency:"mxn",unit_amount:100*e,"product_data[name]":"Gold Plan"},{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer sk_test_IKYCHOAmUhC7IPTdaoVtO58D"}});W.value=a.data.id}catch(a){console.error("No pudimos agregar el precio",a)}},oe=()=>{if(ee.value=G.value,J.value.date_out=V.value.date_out,J.value.date_in=V.value.date_in,E.value=ee.value.price,R.value=le(J.value.date_out,J.value.date_in),console.log("Total",R.value),R.value){Z.value=E.value*R.value*1.1;const e=1.1*E.value;ue(parseInt(e.toFixed(2)))}};te.value;const ie=e=>{var a;J.value.date_out=null!==(a=e.detail.value)&&void 0!==a?a:"",console.log("handdle",J.value.date_out)},de=e=>{var a;J.value.date_in=null!==(a=e.detail.value)&&void 0!==a?a:"",console.log("handdle",J.value.date_in)};return C((()=>{a.fullPath.includes("reservation")&&a.query.department?oe():(async()=>{if(Q.departmentInfo&&(ee.value=Q.departmentInfo,E.value=Q.departmentInfo.price,R.value=le(J.value.date_out,J.value.date_in),R.value)){Z.value=E.value*R.value*1.1;const e=1.1*E.value;ue(parseInt(e.toFixed(2)))}})()})),T((()=>[G.value,V.value]),(e=>{oe(),console.log("El valor de date_out ha cambiado a:",e)})),(e,a)=>($(),j(z,null,[O(N(h),{class:"ion-padding-vertical w-full card-content"},{default:M((()=>[O(N(u),null,{default:M((()=>[O(N(o),{class:"ml-3"},{default:M((()=>{var e;return[A(P(null===(e=ee.value)||void 0===e?void 0:e.name),1)]})),_:1}),O(N(i),{class:"ml-3"},{default:M((()=>{var e;return[A("$"+P(null===(e=ee.value)||void 0===e?void 0:e.price)+" MXN p/noche",1)]})),_:1}),O(N(d)),O(N(s),{class:"p-0"},{default:M((()=>[O(N(d),null,{default:M((()=>[O(N(r),null,{default:M((()=>[A("Día de entrada")])),_:1}),O(N(c),{datetime:"datetimeIn"}),O(N(v),{"keep-contents-mounted":!0},{default:M((()=>[O(N(p),{id:"datetimeIn","is-date-enabled":L,presentation:"date",value:J.value.date_in,"format-options":Y.value,onIonChange:de},null,8,["value","format-options"])])),_:1})])),_:1})])),_:1}),O(N(s),{class:"p-0"},{default:M((()=>[O(N(d),{lines:"inset"},{default:M((()=>[O(N(r),null,{default:M((()=>[A("Día de Salida")])),_:1}),O(N(c),{datetime:"datetimeOut"}),O(N(v),{"keep-contents-mounted":!0},{default:M((()=>[O(N(p),{id:"datetimeOut",presentation:"date",value:J.value.date_out,"format-options":Y.value,onIonChange:ie},null,8,["value","format-options"])])),_:1})])),_:1})])),_:1})])),_:1}),F.value?q("",!0):($(),S(N(_),{key:0,onClick:a[0]||(a[0]=e=>{return a=W.value,void(te.value?ne(a):I.push("/login"));var a}),class:"mx-5",expand:"block"},{default:M((()=>[A(" Reservar ")])),_:1})),F.value?($(),S(N(_),{key:1,disabled:"",expand:"block",class:"ion-margin"},{default:M((()=>[A(" Revisa las fechas ")])),_:1})):q("",!0),O(N(d),{lines:"inset"},{default:M((()=>[O(N(m),{class:"ion-padding-start"},{default:M((()=>[H])),_:1})])),_:1}),O(N(d),{lines:"inset"},{default:M((()=>[O(N(f),{size:"6"},{default:M((()=>[O(N(m),{class:"ion-padding-start ion-no-margin text-base"},{default:M((()=>{var e;return[X("u",null,"$"+P(null===(e=ee.value)||void 0===e?void 0:e.price)+" MXN x "+P(R.value)+" noches",1)]})),_:1})])),_:1}),O(N(f),{size:"6"},{default:M((()=>[O(N(g),{class:"ion-justify-content-end ion-margin-end"},{default:M((()=>{var e;return[null!==(e=ee.value)&&void 0!==e&&e.price&&R.value?($(),S(N(m),{key:0,class:"ion-no-margin text-base"},{default:M((()=>{var e;return[A("$"+P((null===(e=ee.value)||void 0===e?void 0:e.price)*R.value)+" MXN",1)]})),_:1})):F.value?q("",!0):($(),S(N(m),{key:1},{default:M((()=>[A("???")])),_:1}))]})),_:1})])),_:1})])),_:1}),O(N(d),{lines:"inset"},{default:M((()=>[O(N(f),null,{default:M((()=>[O(N(m),{class:"ion-padding-start ion-no-margin text-lg"},{default:M((()=>[K,O(N(y),{icon:N(l)},null,8,["icon"])])),_:1})])),_:1}),O(N(f),null,{default:M((()=>[O(N(g),{class:"ion-justify-content-end ion-margin-end"},{default:M((()=>[ee.value&&R.value?($(),S(N(m),{key:0,class:"ion-no-margin text-base"},{default:M((()=>[A("$"+P(ee.value.price*R.value*.1)+" MXN",1)])),_:1})):F.value?q("",!0):($(),S(N(m),{key:1},{default:M((()=>[A("???")])),_:1}))])),_:1})])),_:1})])),_:1}),O(N(d),{lines:"inset"},{default:M((()=>[O(N(f),null,{default:M((()=>[O(N(m),{class:"ion-padding-start"},{default:M((()=>[U])),_:1})])),_:1}),O(N(f),null,{default:M((()=>[O(N(g),{class:"ion-justify-content-end ion-margin-end"},{default:M((()=>[Z.value?($(),S(N(m),{key:0,class:"ion-padding-start text-base"},{default:M((()=>[X("b",null,"$"+P(Z.value.toFixed(2)),1)])),_:1})):F.value?q("",!0):($(),S(N(m),{key:1},{default:M((()=>[A("???")])),_:1}))])),_:1})])),_:1})])),_:1})])),_:1}),O(N(x),{"is-open":B.value,position:"middle",message:"Agrega los días que quieres quedarte","position-anchor":"footer",duration:2e3,onDidDismiss:a[1]||(a[1]=e=>B.value=!1)},null,8,["is-open"])],64))}}),[["__scopeId","data-v-53e10cf6"]]))}}}));
