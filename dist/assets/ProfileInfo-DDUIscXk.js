import{d as X,r as m,u as T,ah as le,o as c,c as D,g as l,w as a,e,I as G,h as Y,s as p,t as r,z as Q,k as Z,m as w,X as f,q as v,aH as R,K as E,H as M,b as g,aI as j,C as J,v as ee,aJ as K,a as ae,f as oe,a0 as te,i as ne,aa as ue,n as se,L as de,P as re,T as z,W as ie,R as I,aK as C,aL as ce,aM as me,l as fe,x as pe,y as ve}from"./index-CUp2qGmE.js";import{u as ye,g as _e,a as ge}from"./user-Cm6eI9op.js";import{h as q}from"./https-BqIIIB56.js";import{_ as be}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./axios-CwoVb0Lo.js";const ke=()=>q.get("/api/countries"),Ie=y=>q.get("/api/countries/".concat(y,"/states")),Ve=y=>q.get("/api/states/".concat(y,"/cities")),Ce=X({__name:"ModalProfile",props:{userId:Object,avatar:File},setup(y){var i,t;const u=m({id:0,email:"",name:"",first_name:"",second_name:"",password:"",role_id:0,city_id:0,deleted_at:null}),S=y,F=()=>K.dismiss(null,"cancel");T();const b=m(),h=m(),$=m(),V=m([]),k=m(),d=m([]);u.value=S.userId,b.value=(i=u.value.city)==null?void 0:i.state.country_id,h.value=(t=u.value.city)==null?void 0:t.state_id,k.value=u.value.city_id;const _=async()=>{try{$.value=(await ke()).data}catch(o){console.error("Hubo un error al traer las ciudades")}},U=async o=>{try{V.value=(await Ie(o)).data}catch(s){console.error("Hubo un error al traer los estados")}},x=async o=>{try{d.value=(await Ve(o)).data}catch(s){console.log("Hubo un error en al traer las ciudades")}},A=o=>{console.log("Selected country ID:",o.detail.value),U(o.detail.value)},L=o=>{console.log("Selected State ID:",o.detail.value),x(o.detail.value)},B=o=>{console.log("Selected City ID:",o.detail.value),u.value.city_id=o.detail.value},H=async()=>{var n,W;const o={email:u.value.email,name:u.value.name,first_name:u.value.first_name,second_name:u.value.second_name,phone:u.value.phone,city_id:u.value.city_id,image:S.avatar},s=new FormData;for(const N in o)if(Object.prototype.hasOwnProperty.call(o,N)){const O=N,P=o[O];P instanceof File?s.append(O,P):s.append(O,(n=P==null?void 0:P.toString())!=null?n:"")}try{const N=(await ye((W=S.userId)==null?void 0:W.id,s)).data;K.dismiss("confirm")}catch(N){console.error("Algo salio mal al actualizar.")}};return le(()=>{var o,s;_(),U((o=u.value.city)==null?void 0:o.state.country_id),x((s=u.value.city)==null?void 0:s.state_id)}),(o,s)=>(c(),D(E,null,[l(e(Z),null,{default:a(()=>[l(e(G),null,{default:a(()=>[l(e(Y),{slot:"start"},{default:a(()=>[l(e(p),{color:"medium",onClick:F},{default:a(()=>[r("Cancel")]),_:1})]),_:1}),l(e(Q),null,{default:a(()=>[r("Actualiza tú información")]),_:1}),l(e(Y),{slot:"end"},{default:a(()=>[l(e(p),{onClick:H,strong:!0},{default:a(()=>[r("Confirm")]),_:1})]),_:1})]),_:1})]),_:1}),l(e(ee),{class:"ion-padding"},{default:a(()=>[w("form",{onSubmit:H},[l(e(f),null,{default:a(()=>[l(e(v),{"label-placement":"stacked",label:"Cambia tu nombre(s)",modelValue:u.value.name,"onUpdate:modelValue":s[0]||(s[0]=n=>u.value.name=n),placeholder:"Your name"},null,8,["modelValue"])]),_:1}),l(e(f),null,{default:a(()=>[l(e(v),{"label-placement":"stacked",label:"Cambia tu primer apellido",modelValue:u.value.first_name,"onUpdate:modelValue":s[1]||(s[1]=n=>u.value.first_name=n),placeholder:"Your second name"},null,8,["modelValue"])]),_:1}),l(e(f),null,{default:a(()=>[l(e(v),{"label-placement":"stacked",label:"Cambia tu segundo apellido",modelValue:u.value.second_name,"onUpdate:modelValue":s[2]||(s[2]=n=>u.value.second_name=n),placeholder:"Your last name"},null,8,["modelValue"])]),_:1}),l(e(f),null,{default:a(()=>[l(e(v),{"label-placement":"stacked",label:"Cambia tu cuenta de email",modelValue:u.value.email,"onUpdate:modelValue":s[3]||(s[3]=n=>u.value.email=n),placeholder:"Your email"},null,8,["modelValue"])]),_:1}),l(e(f),null,{default:a(()=>[l(e(v),{"label-placement":"stacked",label:"Cambia tu telefono",modelValue:u.value.phone,"onUpdate:modelValue":s[4]||(s[4]=n=>u.value.phone=n),placeholder:"(+52) 888-88-88"},null,8,["modelValue"])]),_:1}),l(e(f),{lines:"none"},{default:a(()=>[l(e(R),{modelValue:b.value,"onUpdate:modelValue":s[5]||(s[5]=n=>b.value=n),onIonChange:A,class:"mt-3 mr-2",label:"País","label-placement":"floating",fill:"outline"},{default:a(()=>[(c(!0),D(E,null,M($.value,n=>(c(),g(e(j),{value:n.id},{default:a(()=>[r(J(n.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"]),l(e(R),{modelValue:h.value,"onUpdate:modelValue":s[6]||(s[6]=n=>h.value=n),onIonChange:L,class:"mt-3 mr-2",label:"Estado","label-placement":"floating",fill:"outline"},{default:a(()=>[(c(!0),D(E,null,M(V.value,n=>(c(),g(e(j),{value:n.id},{default:a(()=>[r(J(n.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"]),l(e(R),{modelValue:k.value,"onUpdate:modelValue":s[7]||(s[7]=n=>k.value=n),onIonChange:B,class:"mt-3",label:"Ciudad","label-placement":"floating",fill:"outline"},{default:a(()=>[(c(!0),D(E,null,M(d.value,n=>(c(),g(e(j),{value:n.id},{default:a(()=>[r(J(n.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),_:1})],32)]),_:1})],64))}}),we=y=>(pe("data-v-d324fb62"),y=y(),ve(),y),Se={class:"h-full flex flex-column justify-content-center align-items-center"},he=["src"],Ue=we(()=>w("img",{class:"border-circle",alt:"Silhouette of a person's head",src:"https://ionicframework.com/docs/img/demos/avatar.svg"},null,-1)),xe=X({__name:"ProfileInfo",setup(y){const u=T(),S=ae(()=>u.userInfo),F=JSON.parse(S.value),b=m(!1),h=T(),$=oe(),V=m(!1),k=m(),d=m({deleted_at:null}),_=async()=>{const i=await K.create({component:Ce,componentProps:{userId:d.value,avatar:x.value}});i.present();const{data:t,role:o}=await i.onWillDismiss();t==="confirm"&&await B()},U=()=>{document.getElementById("file-upload").click()},x=m(),A=i=>{const t=i.target.files[0];x.value=t,H(t)},L=()=>{h.logout(),V.value=!0,$.replace("/")},B=async()=>{var i,t;try{d.value=(await _e(F.id)).data,console.log("NAME",(i=d.value.city)==null?void 0:i.state.country),k.value=(t=d.value.city)==null?void 0:t.state.country.name}catch(o){console.error("Hubo un errror al traer la información del usuario.")}},H=async i=>{const t=new FormData;t.append("image",i);try{const o=await ge(d.value.id,t);await B(),console.log("RES",o.data)}catch(o){console.error("Algo salio mal al actualizar.")}};return te(()=>{B()}),(i,t)=>(c(),D(E,null,[l(e(Z),null,{default:a(()=>[l(e(G),null,{default:a(()=>[l(e(Y),{slot:"start"},{default:a(()=>[l(e(ne),{defaultHref:"/departments",icon:e(ue)},null,8,["icon"])]),_:1}),l(e(Q),null,{default:a(()=>[r("Perfil personal")]),_:1})]),_:1})]),_:1}),l(e(fe),null,{default:a(()=>[l(e(ee),null,{default:a(()=>[w("div",Se,[l(e(se),{class:"mb-6 w-full md:w-30rem"},{default:a(()=>[l(e(de),{class:"flex justify-content-center mt-5"},{default:a(()=>[d.value.avatar?(c(),g(e(re),{key:0,onClick:U,class:"avatar_btn",as:"ion-button"},{default:a(()=>[w("img",{alt:"Silhouette of a person's head",src:d.value.avatar},null,8,he),w("input",{type:"file",id:"file-upload",style:{display:"none"},onChange:A},null,32)]),_:1})):d.value.avatar?z("",!0):(c(),g(e(p),{key:1,class:"w-2 h-2",onClick:U,size:"large",fill:"outline",color:"dark"},{default:a(()=>[w("input",{type:"file",id:"file-upload",style:{display:"none"},onChange:A},null,32),Ue]),_:1}))]),_:1}),l(e(ie),{class:"mt-5"},{default:a(()=>[l(e(f),null,{default:a(()=>[l(e(v),{label:"Nombre(s):",placeholder:"Jonh",modelValue:d.value.name,"onUpdate:modelValue":t[0]||(t[0]=o=>d.value.name=o),"label-placement":"stacked",readonly:""},null,8,["modelValue"]),l(e(p),{fill:"outline",color:"dark",onClick:t[1]||(t[1]=o=>_())},{default:a(()=>[r(" Edit "),l(e(I),{slot:"end",icon:e(C),color:"dark"},null,8,["icon"])]),_:1})]),_:1}),l(e(f),null,{default:a(()=>[l(e(v),{label:"Primer apellido:",placeholder:"Cena",modelValue:d.value.first_name,"onUpdate:modelValue":t[2]||(t[2]=o=>d.value.first_name=o),"label-placement":"stacked",readonly:""},null,8,["modelValue"]),l(e(p),{fill:"outline",color:"dark",onClick:t[3]||(t[3]=o=>_())},{default:a(()=>[r(" Edit "),l(e(I),{slot:"end",icon:e(C),color:"dark"},null,8,["icon"])]),_:1})]),_:1}),l(e(f),null,{default:a(()=>[l(e(v),{label:"Segundo apellido:",placeholder:"Rodríguez",modelValue:d.value.second_name,"onUpdate:modelValue":t[4]||(t[4]=o=>d.value.second_name=o),"label-placement":"stacked",readonly:""},null,8,["modelValue"]),l(e(p),{fill:"outline",color:"dark",onClick:t[5]||(t[5]=o=>_())},{default:a(()=>[r(" Edit "),l(e(I),{slot:"end",icon:e(C),color:"dark"},null,8,["icon"])]),_:1})]),_:1}),l(e(f),null,{default:a(()=>[l(e(v),{label:"email",placeholder:"email@email.com",modelValue:d.value.email,"onUpdate:modelValue":t[6]||(t[6]=o=>d.value.email=o),"label-placement":"stacked",readonly:!b.value},null,8,["modelValue","readonly"]),b.value?z("",!0):(c(),g(e(p),{key:0,fill:"outline",color:"dark",onClick:t[7]||(t[7]=o=>_())},{default:a(()=>[r(" Edit "),l(e(I),{slot:"end",icon:e(C),color:"dark"},null,8,["icon"])]),_:1})),b.value?(c(),g(e(p),{key:1,fill:"outline",color:"dark"},{default:a(()=>[r(" Save "),l(e(I),{slot:"end",icon:e(ce),color:"dark"},null,8,["icon"])]),_:1})):z("",!0)]),_:1}),l(e(f),null,{default:a(()=>[l(e(v),{label:"Phone",placeholder:"(+52) 888-888-88-88",modelValue:d.value.phone,"onUpdate:modelValue":t[8]||(t[8]=o=>d.value.phone=o),"label-placement":"stacked",readonly:""},null,8,["modelValue"]),l(e(p),{fill:"outline",color:"dark",onClick:t[9]||(t[9]=o=>_())},{default:a(()=>[r(" Edit "),l(e(I),{slot:"end",icon:e(C),color:"dark"},null,8,["icon"])]),_:1})]),_:1}),l(e(f),null,{default:a(()=>[l(e(v),{label:"País",placeholder:"your country",modelValue:k.value,"onUpdate:modelValue":t[10]||(t[10]=o=>k.value=o),"label-placement":"stacked",readonly:""},null,8,["modelValue"]),l(e(p),{fill:"outline",color:"dark",onClick:t[11]||(t[11]=o=>_())},{default:a(()=>[r(" Edit "),l(e(I),{slot:"end",icon:e(C),color:"dark"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),l(e(p),{onClick:L,class:"px-1 w-full md:w-30rem",expand:"block",fill:"outline",color:"dark"},{default:a(()=>[r("Cerrar Sesión")]),_:1}),V.value?(c(),g(e(me),{key:0,"is-open":V.value,message:"Cerrando sessión...",spinner:"circles",duration:2e3},null,8,["is-open"])):z("",!0)])]),_:1})]),_:1})],64))}}),Ae=be(xe,[["__scopeId","data-v-d324fb62"]]);export{Ae as default};
