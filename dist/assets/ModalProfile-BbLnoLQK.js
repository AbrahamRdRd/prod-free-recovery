import{m as oe,n as L,l as W,A as ne,p as ue,x as p,s as C,t as h,v as k,q as re,G as J}from"./@ionic-D3TE2VMj.js";import{a as se}from"./user-BFErX62a.js";import{g as de,c as ie}from"./countries-DKgZkDfK.js";import{h as Q}from"./https-ydxeCDJp.js";import{d as me,r as i,aG as ce,aM as s,a1 as v,aa as o,by as n,be as t,a9 as c,H as V,aU as U,$ as w,b7 as g,a0 as pe}from"./@vue-yfti66JX.js";import"./@stencil-CHpqkKxm.js";import"./vue-router-C1vmwl4t.js";import"./ionicons-lnr37WKp.js";import"./axios-CwoVb0Lo.js";import"./index-dYhw7l_n.js";import"./pinia-FlwmMssk.js";import"./crypto-js-BD323iWx.js";import"./register-service-worker-TYP_X6yW.js";/* empty css                  */import"./vue-toast-notification-CyaKMIrI.js";import"./vue-AlRGbnWJ.js";const ve=f=>Q.get("/api/countries/".concat(f,"/states")),fe=f=>Q.get("/api/states/".concat(f,"/cities")),He=me({__name:"ModalProfile",props:{userId:Object,avatar:File},setup(f){var A,M,T,z,G;const e=i(),S=f,X=()=>J.dismiss(null,"cancel"),x=i(),N=i(),H=i(),q=i([]),B=i(),D=i([]),F=i();e.value=S.userId,x.value=(M=(A=e.value)==null?void 0:A.city)==null?void 0:M.state.country_id,N.value=(z=(T=e.value)==null?void 0:T.city)==null?void 0:z.state_id,B.value=(G=e.value)==null?void 0:G.city_id;const Z=async()=>{try{H.value=(await de()).data}catch(u){console.error("Hubo un error al traer las ciudades")}},O=async u=>{try{q.value=(await ve(u)).data}catch(a){console.error("Hubo un error al traer los estados")}},Y=async u=>{try{D.value=(await fe(u)).data}catch(a){console.error("Hubo un error en al traer las ciudades",a)}},ee=u=>{O(u.detail.value)},ae=u=>{Y(u.detail.value)},le=u=>{if(e.value){const a=Number(u.detail.value);isNaN(a)?console.error("Invalid City ID:",u.detail.value):e.value.city_id=a}else console.error("Request object is not initialized.")},te=async()=>{try{F.value=(await ie()).data}catch(u){console.error("We couldn't onbtain the country codes")}},j=async()=>{var l,d,r,m,y,_,P,R,E,K;const u={email:(l=e.value)==null?void 0:l.email,name:(d=e.value)==null?void 0:d.name,first_name:(r=e.value)==null?void 0:r.first_name,second_name:(m=e.value)==null?void 0:m.second_name,phone:(y=e.value)==null?void 0:y.phone,city_id:(_=e.value)==null?void 0:_.city_id,image:S.avatar,country_code_id:(R=(P=e.value)==null?void 0:P.country_code)==null?void 0:R.id},a=new FormData;for(const I in u)if(Object.prototype.hasOwnProperty.call(u,I)){const $=I,b=u[$];b instanceof File?a.append($,b):a.append($,(E=b==null?void 0:b.toString())!=null?E:"")}try{const I=(await se((K=S.userId)==null?void 0:K.id,a)).data;J.dismiss("confirm")}catch(I){console.error("Algo salio mal al actualizar.")}};return ce(()=>{var u,a,l,d,r,m,y,_;Z(),te(),(((a=(u=e.value)==null?void 0:u.city)==null?void 0:a.state.country_id)!=null||((d=(l=e.value)==null?void 0:l.city)==null?void 0:d.state_id)!=null)&&(O((m=(r=e.value)==null?void 0:r.city)==null?void 0:m.state.country_id),Y((_=(y=e.value)==null?void 0:y.city)==null?void 0:_.state_id))}),(u,a)=>(s(),v(V,null,[o(t(ue),null,{default:n(()=>[o(t(oe),null,{default:n(()=>[o(t(L),{slot:"start"},{default:n(()=>[o(t(W),{color:"medium",onClick:X},{default:n(()=>[c("Cancel")]),_:1})]),_:1}),o(t(ne),null,{default:n(()=>[c("Update your information")]),_:1}),o(t(L),{slot:"end"},{default:n(()=>[o(t(W),{onClick:j,strong:!0},{default:n(()=>[c("Confirm")]),_:1})]),_:1})]),_:1})]),_:1}),o(t(re),{class:"ion-padding"},{default:n(()=>[e.value?(s(),v("form",{key:0,onSubmit:j},[o(t(p),null,{default:n(()=>[o(t(C),{"label-placement":"stacked",label:"Change your name(s)",modelValue:e.value.name,"onUpdate:modelValue":a[0]||(a[0]=l=>e.value.name=l),placeholder:"Your name"},null,8,["modelValue"])]),_:1}),o(t(p),null,{default:n(()=>[o(t(C),{"label-placement":"stacked",label:"Change our second name",modelValue:e.value.first_name,"onUpdate:modelValue":a[1]||(a[1]=l=>e.value.first_name=l),placeholder:"Your second name"},null,8,["modelValue"])]),_:1}),o(t(p),null,{default:n(()=>[o(t(C),{"label-placement":"stacked",label:"Change your last name",modelValue:e.value.second_name,"onUpdate:modelValue":a[2]||(a[2]=l=>e.value.second_name=l),placeholder:"Your last name"},null,8,["modelValue"])]),_:1}),o(t(p),null,{default:n(()=>[o(t(C),{"label-placement":"stacked",label:"Change your email",modelValue:e.value.email,"onUpdate:modelValue":a[3]||(a[3]=l=>e.value.email=l),placeholder:"Your email"},null,8,["modelValue"])]),_:1}),o(t(p),null,{default:n(()=>{var l,d;return[o(t(h),{modelValue:e.value.country_code,"onUpdate:modelValue":a[4]||(a[4]=r=>e.value.country_code=r),label:"".concat((l=e.value.country_code)==null?void 0:l.iso3," +").concat((d=e.value.country_code)==null?void 0:d.phone_code),class:"w-2 mr-4"},{default:n(()=>[(s(!0),v(V,null,U(F.value,(r,m)=>(s(),w(t(k),{key:m,value:r},{default:n(()=>[c(g(r.iso3)+" +"+g(r.phone_code),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","label"]),o(t(C),{class:"w-9","label-placement":"stacked",label:"Change your phone number",modelValue:e.value.phone,"onUpdate:modelValue":a[5]||(a[5]=r=>e.value.phone=r),placeholder:"(+52) 888-88-88"},null,8,["modelValue"])]}),_:1}),o(t(p),{lines:"none"},{default:n(()=>[o(t(h),{modelValue:x.value,"onUpdate:modelValue":a[6]||(a[6]=l=>x.value=l),onIonChange:ee,class:"mt-3 mr-2",label:"Country","label-placement":"floating",fill:"outline"},{default:n(()=>[(s(!0),v(V,null,U(H.value,l=>(s(),w(t(k),{value:l.id},{default:n(()=>[c(g(l.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"]),o(t(h),{modelValue:N.value,"onUpdate:modelValue":a[7]||(a[7]=l=>N.value=l),onIonChange:ae,class:"mt-3 mr-2",label:"State","label-placement":"floating",fill:"outline"},{default:n(()=>[(s(!0),v(V,null,U(q.value,l=>(s(),w(t(k),{value:l.id},{default:n(()=>[c(g(l.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"]),o(t(h),{modelValue:B.value,"onUpdate:modelValue":a[8]||(a[8]=l=>B.value=l),onIonChange:le,class:"mt-3",label:"City","label-placement":"floating",fill:"outline"},{default:n(()=>[(s(!0),v(V,null,U(D.value,l=>(s(),w(t(k),{value:l.id},{default:n(()=>[c(g(l.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"])]),_:1})],32)):pe("",!0)]),_:1})],64))}});export{He as default};
